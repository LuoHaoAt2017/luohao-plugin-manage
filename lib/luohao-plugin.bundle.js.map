{"version":3,"file":"luohao-plugin.bundle.js","sources":["../src/typings/index.ts","../src/plugins/baidu-ocr.ts","../src/plugin-manage.ts"],"sourcesContent":["\r\n\r\nexport interface PluginOption {\r\n\r\n}\r\n\r\nexport abstract class Plugin {\r\n  public abstract invoke(serviceName, ...args);\r\n}","import { Plugin } from '../typings';\r\n\r\nexport default class BaiduOcr extends Plugin {\r\n\r\n  public static code: String = 'baidu_orc';\r\n\r\n  private static SERVICES: Map<String, String> = new Map([\r\n    ['idcard', '身份证'],\r\n    ['bank_card', '银行卡'],\r\n    ['driving_license', '驾驶证'],\r\n    ['vehicle_license', '行驶证'],\r\n    ['quota_invoice', '定额发票'],\r\n  ])\r\n\r\n  list() {\r\n    return BaiduOcr.SERVICES;\r\n  }\r\n\r\n  mapping(name) {\r\n    return BaiduOcr.SERVICES.get(name);\r\n  }\r\n\r\n  invoke(serviceName, ...args) {\r\n    return new Promise((resolve) => {\r\n      console.log(`${serviceName} 服务调用中...`, ...args);\r\n      setTimeout(() => {\r\n        resolve(true);\r\n      }, 2000);\r\n    });\r\n  }\r\n}","import { PluginOption, Plugin } from './typings';\r\nimport BaiduOcr from './plugins/baidu-ocr';\r\n\r\n// 插件管理中心\r\nexport default class PluginManage {\r\n\r\n  private plugins: Map<String, Plugin>;\r\n\r\n  private static instance: PluginManage;\r\n\r\n  // 单例模式\r\n  private constructor() {\r\n    this.plugins = new Map();\r\n  }\r\n\r\n  // 获取插件管理中心实例\r\n  public getInstance(): PluginManage {\r\n    if (!PluginManage.instance) {\r\n      PluginManage.instance = new PluginManage();\r\n    }\r\n    return PluginManage.instance;\r\n  }\r\n\r\n  public install(host: any, opts: PluginOption) {\r\n    // 实例化插件管理中心\r\n    this.getInstance();\r\n\r\n    // 注册所有的插件\r\n    this.plugins.set(BaiduOcr.code, new BaiduOcr());\r\n\r\n    // 挂载插件管理实例到 host 上\r\n    if (host.prototype) {\r\n      host.prototype.$plugins = PluginManage.instance;\r\n    }\r\n    window.$plugins = PluginManage.instance;\r\n  }\r\n\r\n  public invoke(pluginCode, serviceName, ...args): Promise<any> {\r\n    const plugin: Plugin | undefined = this.plugins.get(pluginCode);\r\n    if (plugin) {\r\n      return plugin.invoke(serviceName, ...args);\r\n    } else {\r\n      return Promise.reject(-1);\r\n    }\r\n  }\r\n}\r\n"],"names":["Plugin","BaiduOcr","SERVICES","name","get","serviceName","args","Promise","resolve","console","log","setTimeout","Map","PluginManage","plugins","instance","host","opts","getInstance","set","code","prototype","$plugins","window","pluginCode","plugin","invoke","reject"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAMsBA,MAAtB;AAAA;AAAA;;ICJqBC;;;;;;;;;;;;;2BAYZ;AACL,aAAOA,QAAQ,CAACC,QAAhB;AACD;;;4BAEOC,MAAM;AACZ,aAAOF,QAAQ,CAACC,QAAT,CAAkBE,GAAlB,CAAsBD,IAAtB,CAAP;AACD;;;2BAEME,aAAsB;AAAA,wCAANC,IAAM;AAANA,QAAAA,IAAM;AAAA;;AAC3B,aAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAAA;;AAC9B,oBAAAC,OAAO,EAACC,GAAR,4BAAeL,WAAf,gDAA0CC,IAA1C;;AACAK,QAAAA,UAAU,CAAC,YAAM;AACfH,UAAAA,OAAO,CAAC,IAAD,CAAP;AACD,SAFS,EAEP,IAFO,CAAV;AAGD,OALM,CAAP;AAMD;;;;EA3BmCR;;gBAAjBC,kBAEU;;gBAFVA,sBAI4B,IAAIW,GAAJ,CAAQ,CACrD,CAAC,QAAD,EAAW,KAAX,CADqD,EAErD,CAAC,WAAD,EAAc,KAAd,CAFqD,EAGrD,CAAC,iBAAD,EAAoB,KAApB,CAHqD,EAIrD,CAAC,iBAAD,EAAoB,KAApB,CAJqD,EAKrD,CAAC,eAAD,EAAkB,MAAlB,CALqD,CAAR;;ICF5BC;AAMnB;AACA,0BAAsB;AAAA;;AAAA;;AACpB,SAAKC,OAAL,GAAe,IAAIF,GAAJ,EAAf;AACD;;;;;kCAGkC;AACjC,UAAI,CAACC,YAAY,CAACE,QAAlB,EAA4B;AAC1BF,QAAAA,YAAY,CAACE,QAAb,GAAwB,IAAIF,YAAJ,EAAxB;AACD;;AACD,aAAOA,YAAY,CAACE,QAApB;AACD;;;4BAEcC,MAAWC,MAAoB;AAC5C;AACA,WAAKC,WAAL,GAF4C;;AAK5C,WAAKJ,OAAL,CAAaK,GAAb,CAAiBlB,QAAQ,CAACmB,IAA1B,EAAgC,IAAInB,QAAJ,EAAhC,EAL4C;;AAQ5C,UAAIe,IAAI,CAACK,SAAT,EAAoB;AAClBL,QAAAA,IAAI,CAACK,SAAL,CAAeC,QAAf,GAA0BT,YAAY,CAACE,QAAvC;AACD;;AACDQ,MAAAA,MAAM,CAACD,QAAP,GAAkBT,YAAY,CAACE,QAA/B;AACD;;;2BAEaS,YAAYnB,aAAoC;AAC5D,UAAMoB,MAA0B,GAAG,KAAKX,OAAL,CAAaV,GAAb,CAAiBoB,UAAjB,CAAnC;;AACA,UAAIC,MAAJ,EAAY;AAAA,0CAF4BnB,IAE5B;AAF4BA,UAAAA,IAE5B;AAAA;;AACV,eAAOmB,MAAM,CAACC,MAAP,OAAAD,MAAM,GAAQpB,WAAR,SAAwBC,IAAxB,EAAb;AACD,OAFD,MAEO;AACL,eAAOC,OAAO,CAACoB,MAAR,CAAe,CAAC,CAAhB,CAAP;AACD;AACF;;;;;;gBAxCkBd"}